{
  "openapi": "3.0.3",
  "info": {
    "title": "CryptoAlert Pro API",
    "version": "1.1.0",
    "description": "API REST informativa para alertas/recomendações, social e portfolio read-only. Não executa trades automaticamente."
  },
  "servers": [
    {
      "url": "/v1"
    }
  ],
  "paths": {
    "/me": {
      "get": {
        "summary": "Perfil logado",
        "responses": {
          "200": {
            "description": "Perfil retornado"
          }
        }
      },
      "patch": {
        "summary": "Atualiza perfil",
        "responses": {
          "200": {
            "description": "Perfil atualizado"
          }
        }
      }
    },
    "/auth/accept-invite": {
      "post": {
        "summary": "Aceita convite de Expert"
      }
    },
    "/admin/invites": {
      "get": {
        "summary": "Lista convites"
      },
      "post": {
        "summary": "Cria convite"
      }
    },
    "/admin/invites/{id}/revoke": {
      "post": {
        "summary": "Revoga convite"
      }
    },
    "/admin/influencers": {
      "get": {
        "summary": "Lista Experts"
      }
    },
    "/admin/ops/telemetry": {
      "post": {
        "summary": "Ingestão de telemetria (admin)",
        "parameters": [
          {
            "in": "header",
            "name": "Idempotency-Key",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/admin/ops/events": {
      "post": {
        "summary": "Registro de evento operacional (admin)",
        "parameters": [
          {
            "in": "header",
            "name": "Idempotency-Key",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/admin/ops/analyze": {
      "post": {
        "summary": "Analisa anomalias"
      }
    },
    "/admin/ops/incidents": {
      "get": {
        "summary": "Lista incidentes operacionais"
      }
    },
    "/admin/ops/incidents/{id}/feedback": {
      "post": {
        "summary": "Feedback de incidente"
      }
    },
    "/admin/incidents": {
      "get": {
        "summary": "Painel consolidado de incidentes"
      }
    },
    "/follow": {
      "post": {
        "summary": "Seguir perfil"
      }
    },
    "/follow/{followingId}": {
      "delete": {
        "summary": "Deixar de seguir"
      }
    },
    "/following": {
      "get": {
        "summary": "Lista seguindo"
      }
    },
    "/followers": {
      "get": {
        "summary": "Lista seguidores"
      }
    },
    "/ranking": {
      "get": {
        "summary": "Ranking público por performance percentual"
      }
    },
    "/ranking/friends": {
      "get": {
        "summary": "Ranking de amigos por performance percentual"
      }
    },
    "/alerts": {
      "get": {
        "summary": "Lista alertas informativos",
        "description": "Conteúdo apenas informativo, sem execução automática.",
        "parameters": [
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "enum": [
                "active",
                "closed",
                "all"
              ]
            }
          },
          {
            "in": "query",
            "name": "filter",
            "schema": {
              "type": "string",
              "enum": [
                "all",
                "buy",
                "sell"
              ]
            }
          },
          {
            "in": "query",
            "name": "scope",
            "schema": {
              "type": "string",
              "enum": [
                "following",
                "creator",
                "all"
              ]
            }
          }
        ]
      },
      "post": {
        "summary": "Cria alerta informativo"
      }
    },
    "/alerts/{id}/status": {
      "patch": {
        "summary": "Atualiza status do alerta"
      }
    },
    "/posts": {
      "get": {
        "summary": "Lista posts"
      },
      "post": {
        "summary": "Cria post"
      }
    },
    "/portfolio/connect": {
      "post": {
        "summary": "Conecta exchange read-only"
      }
    },
    "/portfolio/test-connection": {
      "post": {
        "summary": "Testa conexão de exchange"
      }
    },
    "/portfolio/sync": {
      "post": {
        "summary": "Sincroniza portfolio"
      }
    },
    "/portfolio/me": {
      "get": {
        "summary": "Snapshot do portfolio"
      }
    },
    "/portfolio/performance": {
      "get": {
        "summary": "Séries 7D/30D/90D",
        "parameters": [
          {
            "in": "query",
            "name": "range",
            "schema": {
              "type": "string",
              "enum": [
                "7d",
                "30d",
                "90d"
              ]
            }
          }
        ]
      }
    },
    "/portfolio/composition": {
      "get": {
        "summary": "Composição por ativos"
      }
    },
    "/portfolio/reconciliation": {
      "get": {
        "summary": "Reconciliação carteira x ledger"
      }
    },
    "/portfolio/goals-alerts": {
      "get": {
        "summary": "Lê metas e alertas de patrimônio"
      },
      "put": {
        "summary": "Atualiza metas e alertas de patrimônio"
      }
    },
    "/portfolio/visibility": {
      "patch": {
        "summary": "Atualiza visibilidade"
      }
    },
    "/portfolio/public/{username}": {
      "get": {
        "summary": "Portfolio público conforme visibilidade"
      }
    },
    "/influencer/metrics/me": {
      "get": {
        "summary": "Métricas do Expert"
      }
    },
    "/notify/test": {
      "post": {
        "summary": "Push de teste"
      }
    },
    "/push/register": {
      "post": {
        "summary": "Registra token push"
      }
    },
    "/billing/checkout": {
      "post": {
        "summary": "Checkout Stripe"
      }
    },
    "/billing/status": {
      "get": {
        "summary": "Status de billing"
      }
    },
    "/billing/webhook": {
      "post": {
        "summary": "Webhook Stripe (raw body)"
      }
    },
    "/news": {
      "get": {
        "summary": "Feed de notícias normalizado",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "title": {
                            "type": "string"
                          },
                          "source": {
                            "type": "string"
                          },
                          "url": {
                            "type": "string"
                          },
                          "published_at": {
                            "type": "string"
                          },
                          "assets": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          },
                          "summary": {
                            "type": "string"
                          }
                        }
                      }
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "provider": {
                          "type": "string"
                        },
                        "cached": {
                          "type": "boolean"
                        },
                        "ttl_seconds": {
                          "type": "number"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "503": {
            "description": "Provider indisponível e sem cache"
          }
        },
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "category",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "q",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "lang",
            "schema": {
              "type": "string",
              "enum": [
                "pt",
                "en"
              ]
            }
          }
        ]
      }
    },
    "/news/categories": {
      "get": {
        "summary": "Categorias de notícias",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/market/fear-greed": {
      "get": {
        "summary": "Fear & Greed normalizado",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "value": {
                      "type": "number"
                    },
                    "label_pt": {
                      "type": "string"
                    },
                    "label_en": {
                      "type": "string"
                    },
                    "updated_at": {
                      "type": "string"
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "provider": {
                          "type": "string"
                        },
                        "cached": {
                          "type": "boolean"
                        },
                        "ttl_seconds": {
                          "type": "number"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/experts": {
      "get": {
        "summary": "Discovery de Experts"
      }
    },
    "/experts/{username}": {
      "get": {
        "summary": "Perfil de Expert + alertas/posts/portfolio público"
      }
    },
    "/dev/seed": {
      "post": {
        "summary": "Seed de desenvolvimento",
        "parameters": [
          {
            "in": "header",
            "name": "X-Dev-Seed-Key",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "description": "Permitido apenas fora de produção (NODE_ENV != production)."
      }
    },
    "/incident-risk/telemetry": {
      "post": {
        "summary": "Ingestão de telemetria de risco"
      }
    },
    "/incident-risk/etl/run": {
      "post": {
        "summary": "Executa ETL"
      }
    },
    "/incident-risk/model/train": {
      "post": {
        "summary": "Treina modelo"
      }
    },
    "/incident-risk/infer/batch": {
      "post": {
        "summary": "Inferência batch"
      }
    },
    "/incident-risk/infer/live": {
      "get": {
        "summary": "Inferência live"
      }
    },
    "/incident-risk/alerts/evaluate": {
      "post": {
        "summary": "Avalia alertas preventivos"
      }
    },
    "/incident-risk/backtest": {
      "post": {
        "summary": "Backtest"
      }
    },
    "/incident-risk/summary": {
      "get": {
        "summary": "Resumo do modelo"
      }
    },
    "/ops/dashboard": {
      "get": {
        "summary": "Painel operacional (admin)"
      }
    },
    "/ops/alerts": {
      "get": {
        "summary": "Alertas operacionais (admin)"
      }
    }
  }
}
